<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>Minecraft Game</title>
        <p id="round" ></p>
        <h1 id="coach_id" ></h1>
        <h1 id="num_correct" ></h1>
        <h1 id="game_score" ></h1>
<!--        <span type="text" id="messageText"> Default </span>-->
        <link href="{{ url_for('static', path='/styles.css') }}" rel="stylesheet">
        <link rel="stylesheet" href="../static/css/bootstrap.min.css" type="text/css" />
        <link rel="icon" href="../static/favicon.ico" />
        <script>
            var url_string = window.location.href
            var url = new URL(url_string);
            var round_number = url.searchParams.get("round");

            var condition_number = url.searchParams.get("condition");
            var quiz_score = url.searchParams.get("nc");

            var name_id = url.searchParams.get("workerId");

            var clientID = url.searchParams.get("workerId");
            var position_ws = new WebSocket(`ws://52.90.55.207:5000/position/${clientID}`);
            var advice_ws = new WebSocket(`ws://52.90.55.207:5000/advice/${clientID}`);
            var room_ws = new WebSocket(`ws://52.90.55.207:5000/room/${clientID}`);

            //document.getElementById("round").innerHTML = "Round: "+round_number;
            function redirect_to_round2() {
                // document.getElementById("popupForm").style.display = "none";
                //window.location.href = 'https://cmu.ca1.qualtrics.com/jfe/preview/SV_ehRUsIBLIIlj6Sy?Q_CHL=preview&Q_SurveyVersionID=current' + '&condition='+condition_number + '&amt_id='+name_id + '&g2score='+document.getElementById("game_score").value;
                //window.location.href = '/post_game_1?round='+round_number +'&condition='+condition_number + '&workerId='+name_id;
                window.location.href = 'https://cmu.ca1.qualtrics.com/jfe/form/SV_ehRUsIBLIIlj6Sy?Q_SurveyVersionID=1' + '&condition='+condition_number + '&amt_id='+name_id + '&g2score='+document.getElementById("game_score").value;
            }
            document.getElementById("coach_id").value = ""+condition_number;

        </script>
        <style>
		body {
			padding:15px;
			margin: 15px;
			background-color: white;
			color: black;
			font-weight: 300;
			font-size: 15pt;

		}
	</style>
    </head>

    <body>



<!--        <script src="/socket.io/socket.io.js"></script>-->
        <!-- <script src="https://cdn.socket.io/socket.io-1.3.4.js"></script> -->
        <script src="//cdn.jsdelivr.net/npm/phaser@3.3.0/dist/phaser.min.js"></script>
		<script src="//cdn.jsdelivr.net/npm/phaser@3.51.0/dist/phaser.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/phaser-raycaster@0.9.1/dist/phaser-raycaster.min.js"></script>
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script> -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="../static/js/minecraft_game_map1_adapt_first.js"></script>
        <ul id='messages'>
        </ul>
        <span type="text" id="room_name_text"> </span>
        <h3 type="text" id="advice_text"> </h3>
        <script>
            // MAP TIMER
            var count=255;

            var counter=setInterval(timer, 1000); //1000 will  run it every 1 second

            function timer()
            {
            count=count-1;
            //sendMessage();

            if (count >= 245){
                document.onkeydown = function (e) {
                    e.preventDefault();
                }
            }
            else{
                document.onkeydown = function (e) {
                    return true;
                }
            }

            if (count <= 0)
            {
                clearInterval(counter);
                //counter ended, do something here
                redirect_to_round2();
                return;
            }

            //Do code for showing the number of seconds here'
            // document.getElementById("timer").innerHTML= "TIME REMAINING: " +count + " seconds"; // watch for spelling
            }

            window.onload=function(){
                window.setTimeout(function() { document.quiz_form.submit(); }, 255000);
            };


            //position_ws.onmessage = function(event) {
                //var messages = document.getElementById('messages')
                //document.getElementById("messages").innerHTML = event.data
            //};

            //room_ws.onmessage = function(event) {
                //var room_name_text = document.getElementById('room_name_text')
                //document.getElementById("room_name_text").innerHTML = event.data
            //};

            //advice_ws.onmessage = function(event) {
                //var advice_msg_text = document.getElementById('advice_text')
                //document.getElementById("advice_text").innerHTML = event.data
            //};


        </script>

    </body>

</html>



